<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Housing Price Change Chart</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
<style>
body {
font-family: Arial, sans-serif;
text-align: center;
}

svg {
border: 1px solid #ddd;
}

.tooltip {
position: absolute;
background-color: white;
border: 1px solid #ddd;
padding: 5px;
font-size: 14px;
pointer-events: none;
display: none;
text-align: left;
}
</style>
    <h2>按季別房地單價中位數之百分比變化</h2>
    <label for="dataSelect">選擇縣市:</label>
    <select id="dataSelect">
        <option value="Nation">全國</option>
        <option value="Taipei">台北市</option>
        <option value="NewTaipei">新北市</option>
        <option value="Taoyuan">桃園市</option>
        <option value="Taichung">台中市</option>
        <option value="Tainan">台南市</option>
        <option value="Kaohsiung">高雄市</option>
        <option value="HsinchuCity">新竹市</option>
        <option value="HsinchuCounty">新竹縣</option>
    </select>
  <br><br>
  <div class="tooltip" id="tooltip"></div>
  <div id="graph"></div>
  </body>
  
  <script>
        // Set up the SVG canvas
        const margin = { top: 50, right: 100, bottom: 50, left: 60 },
              width = 1500 - margin.left - margin.right,
              height = 500 - margin.top - margin.bottom;

        const svg = d3.select("#graph").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
          .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        // Sample data
        const data = [
  {
    Quarter: "2011_Q1",
    Nation_p: 50249,
    Nation: 0,
    Taipei_p: 183373,
    Taipei: 0,
    NewTaipei_p: 69062,
    NewTaipei: 0,
    Taoyuan_p: 52819,
    Taoyuan: 0,
    Taichung_p: 46384,
    Taichung: 0,
    Tainan_p: 68127,
    Tainan: 0,
    Kaohsiung: 0,
    HsinchuCity: 0,
    HsinchuCounty_p: 32473,
    HsinchuCounty: 0,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2011_Q2",
    Nation_p: 48293,
    Nation: -3.89,
    Taipei_p: 213362,
    Taipei: 16.35,
    NewTaipei_p: 82882,
    NewTaipei: 20.01,
    Taoyuan_p: 62671,
    Taoyuan: 18.65,
    Taichung_p: 54489,
    Taichung: 17.47,
    Tainan_p: 43828,
    Tainan: -35.67,
    Kaohsiung_p: 25290,
    HsinchuCounty_p: 55303,
    HsinchuCounty: 70.3,
    Label: "a",
    Detail: "立法院三讀通過《特種貨物及勞務稅條例》（奢侈稅）"
  },
  {
    Quarter: "2011_Q3",
    Nation_p: 51833,
    Nation: 7.33,
    Taipei_p: 183086,
    Taipei: -14.19,
    NewTaipei_p: 114812,
    NewTaipei: 38.52,
    Taoyuan_p: 54628,
    Taoyuan: -12.83,
    Taichung_p: 52401,
    Taichung: -3.83,
    Tainan_p: 48880,
    Tainan: 11.53,
    Kaohsiung_p: 49851,
    Kaohsiung: 97.12,
    HsinchuCity_p: 15679,
    HsinchuCounty_p: 38110,
    HsinchuCounty: -31.09,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2011_Q4",
    Nation_p: 41664,
    Nation: -19.62,
    Taipei_p: 179377,
    Taipei: -2.03,
    NewTaipei_p: 94375,
    NewTaipei: -17.8,
    Taoyuan_p: 52645,
    Taoyuan: -3.63,
    Taichung_p: 47126,
    Taichung: -10.07,
    Tainan_p: 35644,
    Tainan: -27.08,
    Kaohsiung_p: 46789,
    Kaohsiung: -6.14,
    HsinchuCounty_p: 43162,
    HsinchuCounty: 13.26,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2012_Q1",
    Nation_p: 40870,
    Nation: -1.91,
    Taipei_p: 176212,
    Taipei: -1.76,
    NewTaipei_p: 91013,
    NewTaipei: -3.56,
    Taoyuan_p: 49746,
    Taoyuan: -5.51,
    Taichung_p: 46740,
    Taichung: -0.82,
    Tainan_p: 32850,
    Tainan: -7.84,
    Kaohsiung_p: 38264,
    Kaohsiung: -18.22,
    HsinchuCity_p: 40107,
    HsinchuCounty_p: 43708,
    HsinchuCounty: 1.27,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2012_Q2",
    Nation_p: 46651,
    Nation: 14.14,
    Taipei_p: 180124,
    Taipei: 2.22,
    NewTaipei_p: 84544,
    NewTaipei: -7.11,
    Taoyuan_p: 47062,
    Taoyuan: -5.4,
    Taichung_p: 46766,
    Taichung: 0.06,
    Tainan_p: 38575,
    Tainan: 17.43,
    Kaohsiung_p: 38710,
    Kaohsiung: 1.17,
    HsinchuCity_p: 45597,
    HsinchuCity: 13.69,
    HsinchuCounty_p: 45886,
    HsinchuCounty: 4.98,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2012_Q3",
    Nation_p: 40286,
    Nation: -13.64,
    Taipei_p: 158358,
    Taipei: -12.08,
    NewTaipei_p: 77491,
    NewTaipei: -8.34,
    Taoyuan_p: 34929,
    Taoyuan: -25.78,
    Taichung_p: 38327,
    Taichung: -18.05,
    Tainan_p: 30146,
    Tainan: -21.85,
    Kaohsiung_p: 33508,
    Kaohsiung: -13.44,
    HsinchuCity_p: 42593,
    HsinchuCity: -6.59,
    HsinchuCounty_p: 36796,
    HsinchuCounty: -19.81,
    Label: "b",
    Detail: "正式施行實價登錄制度"
  },
  {
    Quarter: "2012_Q4",
    Nation_p: 41517,
    Nation: 3.06,
    Taipei_p: 154106,
    Taipei: -2.69,
    NewTaipei_p: 80300,
    NewTaipei: 3.62,
    Taoyuan_p: 36274,
    Taoyuan: 3.85,
    Taichung_p: 39482,
    Taichung: 3.01,
    Tainan_p: 32938,
    Tainan: 9.26,
    Kaohsiung_p: 34375,
    Kaohsiung: 2.59,
    HsinchuCity_p: 43164,
    HsinchuCity: 1.34,
    HsinchuCounty_p: 36000,
    HsinchuCounty: -2.16,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2013_Q1",
    Nation_p: 42475,
    Nation: 2.31,
    Taipei_p: 165965,
    Taipei: 7.7,
    NewTaipei_p: 85404,
    NewTaipei: 6.36,
    Taoyuan_p: 38499,
    Taoyuan: 6.13,
    Taichung_p: 39985,
    Taichung: 1.27,
    Tainan_p: 32163,
    Tainan: -2.35,
    Kaohsiung_p: 36092,
    Kaohsiung: 4.99,
    HsinchuCity_p: 47096,
    HsinchuCity: 9.11,
    HsinchuCounty_p: 39656,
    HsinchuCounty: 10.16,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2013_Q2",
    Nation_p: 44591,
    Nation: 4.98,
    Taipei_p: 169373,
    Taipei: 2.05,
    NewTaipei_p: 89004,
    NewTaipei: 4.22,
    Taoyuan_p: 40430,
    Taoyuan: 5.02,
    Taichung_p: 42508,
    Taichung: 6.31,
    Tainan_p: 34539,
    Tainan: 7.39,
    Kaohsiung_p: 36820,
    Kaohsiung: 2.02,
    HsinchuCity_p: 44010,
    HsinchuCity: -6.55,
    HsinchuCounty_p: 38270,
    HsinchuCounty: -3.5,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2013_Q3",
    Nation_p: 45001,
    Nation: 0.92,
    Taipei_p: 171117,
    Taipei: 1.03,
    NewTaipei_p: 93866,
    NewTaipei: 5.46,
    Taoyuan_p: 42926,
    Taoyuan: 6.17,
    Taichung_p: 41734,
    Taichung: -1.82,
    Tainan_p: 33684,
    Tainan: -2.48,
    Kaohsiung_p: 37581,
    Kaohsiung: 2.07,
    HsinchuCity_p: 44753,
    HsinchuCity: 1.69,
    HsinchuCounty_p: 37620,
    HsinchuCounty: -1.7,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2013_Q4",
    Nation_p: 45767,
    Nation: 1.7,
    Taipei_p: 170137,
    Taipei: -0.57,
    NewTaipei_p: 96688,
    NewTaipei: 3.01,
    Taoyuan_p: 43602,
    Taoyuan: 1.57,
    Taichung_p: 45059,
    Taichung: 7.97,
    Tainan_p: 34952,
    Tainan: 3.76,
    Kaohsiung_p: 38262,
    Kaohsiung: 1.81,
    HsinchuCity_p: 45398,
    HsinchuCity: 1.44,
    HsinchuCounty_p: 38645,
    HsinchuCounty: 2.72,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2014_Q1",
    Nation_p: 44906,
    Nation: -1.88,
    Taipei_p: 177790,
    Taipei: 4.5,
    NewTaipei_p: 96502,
    NewTaipei: -0.19,
    Taoyuan_p: 44798,
    Taoyuan: 2.74,
    Taichung_p: 44910,
    Taichung: -0.33,
    Tainan_p: 34204,
    Tainan: -2.14,
    Kaohsiung_p: 38748,
    Kaohsiung: 1.27,
    HsinchuCity_p: 45022,
    HsinchuCity: -0.83,
    HsinchuCounty_p: 39420,
    HsinchuCounty: 2.01,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2014_Q2",
    Nation_p: 46596,
    Nation: 3.76,
    Taipei_p: 177644,
    Taipei: -0.08,
    NewTaipei_p: 96134,
    NewTaipei: -0.38,
    Taoyuan_p: 46452,
    Taoyuan: 3.69,
    Taichung_p: 46162,
    Taichung: 2.79,
    Tainan_p: 36148,
    Tainan: 5.68,
    Kaohsiung_p: 41051,
    Kaohsiung: 5.94,
    HsinchuCity_p: 46416,
    HsinchuCity: 3.1,
    HsinchuCounty_p: 39134,
    HsinchuCounty: -0.73,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2014_Q3",
    Nation_p: 46723,
    Nation: 0.27,
    Taipei_p: 169792,
    Taipei: -4.42,
    NewTaipei_p: 97334,
    NewTaipei: 1.25,
    Taoyuan_p: 46414,
    Taoyuan: -0.08,
    Taichung_p: 46416,
    Taichung: 0.55,
    Tainan_p: 36832,
    Tainan: 1.89,
    Kaohsiung_p: 40604,
    Kaohsiung: -1.09,
    HsinchuCity_p: 49046,
    HsinchuCity: 5.67,
    HsinchuCounty_p: 38824,
    HsinchuCounty: -0.79,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2014_Q4",
    Nation_p: 47656,
    Nation: 2,
    Taipei_p: 170532,
    Taipei: 0.44,
    NewTaipei_p: 97114,
    NewTaipei: -0.23,
    Taoyuan_p: 47333,
    Taoyuan: 1.98,
    Taichung_p: 45362,
    Taichung: -2.27,
    Tainan_p: 37859,
    Tainan: 2.79,
    Kaohsiung_p: 41747,
    Kaohsiung: 2.81,
    HsinchuCity_p: 50000,
    HsinchuCity: 1.95,
    HsinchuCounty_p: 41997,
    HsinchuCounty: 8.17,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2015_Q1",
    Nation_p: 47690,
    Nation: 0.07,
    Taipei_p: 175860,
    Taipei: 3.12,
    NewTaipei_p: 96955,
    NewTaipei: -0.16,
    Taoyuan_p: 46773,
    Taoyuan: -1.18,
    Taichung_p: 48137,
    Taichung: 6.12,
    Tainan_p: 38256,
    Tainan: 1.05,
    Kaohsiung_p: 41040,
    Kaohsiung: -1.69,
    HsinchuCity_p: 49087,
    HsinchuCity: -1.83,
    HsinchuCounty_p: 41940,
    HsinchuCounty: -0.14,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2015_Q2",
    Nation_p: 47893,
    Nation: 0.43,
    Taipei_p: 174624,
    Taipei: -0.7,
    NewTaipei_p: 99578,
    NewTaipei: 2.71,
    Taoyuan_p: 47469,
    Taoyuan: 1.49,
    Taichung_p: 46984,
    Taichung: -2.4,
    Tainan_p: 37928,
    Tainan: -0.86,
    Kaohsiung_p: 41951,
    Kaohsiung: 2.22,
    HsinchuCity_p: 54414,
    HsinchuCity: 10.85,
    HsinchuCounty_p: 42478,
    HsinchuCounty: 1.28,
    Label: "c",
    Detail: "立法院三讀通過房地合一稅1.0"
  },
  {
    Quarter: "2015_Q3",
    Nation_p: 47146,
    Nation: -1.56,
    Taipei_p: 167450,
    Taipei: -4.11,
    NewTaipei_p: 95740,
    NewTaipei: -3.85,
    Taoyuan_p: 45282,
    Taoyuan: -4.61,
    Taichung_p: 47613,
    Taichung: 1.34,
    Tainan_p: 38573,
    Tainan: 1.7,
    Kaohsiung_p: 41916,
    Kaohsiung: -0.08,
    HsinchuCity_p: 52520,
    HsinchuCity: -3.48,
    HsinchuCounty_p: 43304,
    HsinchuCounty: 1.94,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2015_Q4",
    Nation_p: 46742,
    Nation: -0.86,
    Taipei_p: 166970,
    Taipei: -0.29,
    NewTaipei_p: 99982,
    NewTaipei: 4.43,
    Taoyuan_p: 45926,
    Taoyuan: 1.42,
    Taichung_p: 42364,
    Taichung: -11.02,
    Tainan_p: 35528,
    Tainan: -7.89,
    Kaohsiung_p: 45909,
    Kaohsiung: 9.53,
    HsinchuCity_p: 54830,
    HsinchuCity: 4.4,
    HsinchuCounty_p: 44575,
    HsinchuCounty: 2.94,
    Label: "d",
    Detail: "立法院三讀通過制定《國土計畫法》"
  },
  {
    Quarter: "2016_Q1",
    Nation_p: 56874,
    Nation: 21.68,
    Taipei_p: 190692,
    Taipei: 14.21,
    NewTaipei_p: 148904,
    NewTaipei: 48.93,
    Taoyuan_p: 70195,
    Taoyuan: 52.84,
    Taichung_p: 58378,
    Taichung: 37.8,
    Tainan_p: 47839,
    Tainan: 34.65,
    Kaohsiung_p: 68994,
    Kaohsiung: 50.28,
    HsinchuCounty_p: 38451,
    HsinchuCounty: -13.74,
    Label: "e",
    Detail: "奢侈稅房屋停徵"
  },
  {
    Quarter: "2016_Q2",
    Nation_p: 56473,
    Nation: -0.71,
    Taipei_p: 184067,
    Taipei: -3.47,
    NewTaipei_p: 134626,
    NewTaipei: -9.59,
    Taoyuan_p: 55321,
    Taoyuan: -21.19,
    Taichung_p: 55716,
    Taichung: -4.56,
    Tainan_p: 45996,
    Tainan: -3.85,
    Kaohsiung_p: 69185,
    Kaohsiung: 0.28,
    HsinchuCity_p: 47226,
    HsinchuCounty_p: 51276,
    HsinchuCounty: 33.35,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2016_Q3",
    Nation_p: 58958,
    Nation: 4.4,
    Taipei_p: 231375,
    Taipei: 25.7,
    NewTaipei_p: 141293,
    NewTaipei: 4.95,
    Taoyuan_p: 69335,
    Taoyuan: 25.33,
    Taichung_p: 56852,
    Taichung: 2.04,
    Tainan_p: 49426,
    Tainan: 7.46,
    Kaohsiung_p: 49983,
    Kaohsiung: -27.75,
    HsinchuCity_p: 48677,
    HsinchuCity: 3.07,
    HsinchuCounty_p: 49197,
    HsinchuCounty: -4.05,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2016_Q4",
    Nation_p: 54862,
    Nation: -6.95,
    Taipei_p: 188763,
    Taipei: -18.42,
    NewTaipei_p: 125076,
    NewTaipei: -11.48,
    Taoyuan_p: 56382,
    Taoyuan: -18.68,
    Taichung_p: 56272,
    Taichung: -1.02,
    Tainan_p: 52694,
    Tainan: 6.61,
    Kaohsiung_p: 52375,
    Kaohsiung: 4.79,
    HsinchuCity_p: 48764,
    HsinchuCity: 0.18,
    HsinchuCounty_p: 53118,
    HsinchuCounty: 7.97,
    Label: "f",
    Detail: "內政部推出「地籍異動即時通服務」"
  },
  {
    Quarter: "2017_Q1",
    Nation_p: 54352,
    Nation: -0.93,
    Taipei_p: 240614,
    Taipei: 27.47,
    NewTaipei_p: 123238,
    NewTaipei: -1.47,
    Taoyuan_p: 55621,
    Taoyuan: -1.35,
    Taichung_p: 51708,
    Taichung: -8.11,
    Tainan_p: 46515,
    Tainan: -11.73,
    Kaohsiung_p: 86207,
    Kaohsiung: 64.6,
    HsinchuCity_p: 74752,
    HsinchuCity: 53.29,
    HsinchuCounty_p: 48550,
    HsinchuCounty: -8.6,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2017_Q2",
    Nation_p: 54981,
    Nation: 1.16,
    Taipei_p: 189604,
    Taipei: -21.2,
    NewTaipei_p: 55581,
    NewTaipei: -54.9,
    Taoyuan_p: 61498,
    Taoyuan: 10.57,
    Taichung_p: 57716,
    Taichung: 11.62,
    Tainan_p: 49196,
    Tainan: 5.76,
    Kaohsiung_p: 62472,
    Kaohsiung: -27.53,
    HsinchuCity_p: 72066,
    HsinchuCity: -3.59,
    HsinchuCounty_p: 52918,
    HsinchuCounty: 9,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2017_Q3",
    Nation_p: 57558,
    Nation: 4.69,
    Taipei_p: 189032,
    Taipei: -0.3,
    NewTaipei_p: 114330,
    NewTaipei: 105.7,
    Taoyuan_p: 52834,
    Taoyuan: -14.09,
    Taichung_p: 57640,
    Taichung: -0.13,
    Tainan_p: 47902,
    Tainan: -2.63,
    Kaohsiung_p: 55522,
    Kaohsiung: -11.12,
    HsinchuCity_p: 63726,
    HsinchuCity: -11.57,
    HsinchuCounty_p: 48180,
    HsinchuCounty: -8.95,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2017_Q4",
    Nation_p: 51680,
    Nation: -10.21,
    Taipei_p: 168733,
    Taipei: -10.74,
    NewTaipei_p: 95403,
    NewTaipei: -16.55,
    Taoyuan_p: 46865,
    Taoyuan: -11.3,
    Taichung_p: 51018,
    Taichung: -11.49,
    Tainan_p: 42944,
    Tainan: -10.35,
    Kaohsiung_p: 45912,
    Kaohsiung: -17.31,
    HsinchuCity_p: 55811,
    HsinchuCity: -12.42,
    HsinchuCounty_p: 46075,
    HsinchuCounty: -4.37,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2018_Q1",
    Nation_p: 51740,
    Nation: 0.12,
    Taipei_p: 167750,
    Taipei: -0.58,
    NewTaipei_p: 96980,
    NewTaipei: 1.65,
    Taoyuan_p: 46869,
    Taoyuan: 0.01,
    Taichung_p: 53519,
    Taichung: 4.9,
    Tainan_p: 43364,
    Tainan: 0.98,
    Kaohsiung_p: 46334,
    Kaohsiung: 0.92,
    HsinchuCity_p: 54084,
    HsinchuCity: -3.09,
    HsinchuCounty_p: 47537,
    HsinchuCounty: 3.17,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2018_Q2",
    Nation_p: 52324,
    Nation: 1.13,
    Taipei_p: 169444,
    Taipei: 1.01,
    NewTaipei_p: 94717,
    NewTaipei: -2.33,
    Taoyuan_p: 48613,
    Taoyuan: 3.72,
    Taichung_p: 51195,
    Taichung: -4.34,
    Tainan_p: 45376,
    Tainan: 4.64,
    Kaohsiung_p: 44757,
    Kaohsiung: -3.4,
    HsinchuCity_p: 54068,
    HsinchuCity: -0.03,
    HsinchuCounty_p: 46625,
    HsinchuCounty: -1.92,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2018_Q3",
    Nation_p: 52910,
    Nation: 1.12,
    Taipei_p: 167790,
    Taipei: -0.98,
    NewTaipei_p: 96202,
    NewTaipei: 1.57,
    Taoyuan_p: 47506,
    Taoyuan: -2.28,
    Taichung_p: 52693,
    Taichung: 2.93,
    Tainan_p: 43166,
    Tainan: -4.87,
    Kaohsiung_p: 46427,
    Kaohsiung: 3.73,
    HsinchuCity_p: 57906,
    HsinchuCity: 7.1,
    HsinchuCounty_p: 46014,
    HsinchuCounty: -1.31,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2018_Q4",
    Nation_p: 53166,
    Nation: 0.48,
    Taipei_p: 167453,
    Taipei: -0.2,
    NewTaipei_p: 94849,
    NewTaipei: -1.41,
    Taoyuan_p: 48592,
    Taoyuan: 2.29,
    Taichung_p: 54526,
    Taichung: 3.48,
    Tainan_p: 44273,
    Tainan: 2.56,
    Kaohsiung_p: 46202,
    Kaohsiung: -0.48,
    HsinchuCity_p: 56388,
    HsinchuCity: -2.62,
    HsinchuCounty_p: 48080,
    HsinchuCounty: 4.49,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2019_Q1",
    Nation_p: 53508,
    Nation: 0.64,
    Taipei_p: 170464,
    Taipei: 1.8,
    NewTaipei_p: 97592,
    NewTaipei: 2.89,
    Taoyuan_p: 48690,
    Taoyuan: 0.2,
    Taichung_p: 54042,
    Taichung: -0.89,
    Tainan_p: 45076,
    Tainan: 1.81,
    Kaohsiung_p: 47755,
    Kaohsiung: 3.36,
    HsinchuCity_p: 57004,
    HsinchuCity: 1.09,
    HsinchuCounty_p: 49573,
    HsinchuCounty: 3.11,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2019_Q2",
    Nation_p: 54780,
    Nation: 2.38,
    Taipei_p: 171162,
    Taipei: 0.41,
    NewTaipei_p: 99444,
    NewTaipei: 1.9,
    Taoyuan_p: 49594,
    Taoyuan: 1.86,
    Taichung_p: 55552,
    Taichung: 2.79,
    Tainan_p: 46576,
    Tainan: 3.33,
    Kaohsiung_p: 47571,
    Kaohsiung: -0.39,
    HsinchuCity_p: 54710,
    HsinchuCity: -4.02,
    HsinchuCounty_p: 49287,
    HsinchuCounty: -0.58,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2019_Q3",
    Nation_p: 55557,
    Nation: 1.42,
    Taipei_p: 174730,
    Taipei: 2.08,
    NewTaipei_p: 100669,
    NewTaipei: 1.23,
    Taoyuan_p: 50838,
    Taoyuan: 2.51,
    Taichung_p: 57105,
    Taichung: 2.8,
    Tainan_p: 46266,
    Tainan: -0.67,
    Kaohsiung_p: 47714,
    Kaohsiung: 0.3,
    HsinchuCity_p: 55920,
    HsinchuCity: 2.21,
    HsinchuCounty_p: 50435,
    HsinchuCounty: 2.33,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2019_Q4",
    Nation_p: 55833,
    Nation: 0.5,
    Taipei_p: 172644,
    Taipei: -1.19,
    NewTaipei_p: 101746,
    NewTaipei: 1.07,
    Taoyuan_p: 51458,
    Taoyuan: 1.22,
    Taichung_p: 56514,
    Taichung: -1.03,
    Tainan_p: 46620,
    Tainan: 0.77,
    Kaohsiung_p: 48397,
    Kaohsiung: 1.43,
    HsinchuCity_p: 55140,
    HsinchuCity: -1.39,
    HsinchuCounty_p: 51647,
    HsinchuCounty: 2.4,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2020_Q1",
    Nation_p: 55284,
    Nation: -0.98,
    Taipei_p: 169954,
    Taipei: -1.56,
    NewTaipei_p: 99555,
    NewTaipei: -2.15,
    Taoyuan_p: 51481,
    Taoyuan: 0.04,
    Taichung_p: 57421,
    Taichung: 1.6,
    Tainan_p: 47800,
    Tainan: 2.53,
    Kaohsiung_p: 49353,
    Kaohsiung: 1.98,
    HsinchuCity_p: 58144,
    HsinchuCity: 5.45,
    HsinchuCounty_p: 50272,
    HsinchuCounty: -2.66,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2020_Q2",
    Nation_p: 57185,
    Nation: 3.44,
    Taipei_p: 175644,
    Taipei: 3.35,
    NewTaipei_p: 100758,
    NewTaipei: 1.21,
    Taoyuan_p: 52332,
    Taoyuan: 1.65,
    Taichung_p: 57775,
    Taichung: 0.62,
    Tainan_p: 47902,
    Tainan: 0.21,
    Kaohsiung_p: 50298,
    Kaohsiung: 1.91,
    HsinchuCity_p: 58378,
    HsinchuCity: 0.4,
    HsinchuCounty_p: 53514,
    HsinchuCounty: 6.45,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2020_Q3",
    Nation_p: 59780,
    Nation: 4.54,
    Taipei_p: 184564,
    Taipei: 5.08,
    NewTaipei_p: 105063,
    NewTaipei: 4.27,
    Taoyuan_p: 53136,
    Taoyuan: 1.54,
    Taichung_p: 61209,
    Taichung: 5.94,
    Tainan_p: 52323,
    Tainan: 9.23,
    Kaohsiung_p: 52498,
    Kaohsiung: 4.37,
    HsinchuCity_p: 63747,
    HsinchuCity: 9.2,
    HsinchuCounty_p: 54676,
    HsinchuCounty: 2.17,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2020_Q4",
    Nation_p: 60290,
    Nation: 0.85,
    Taipei_p: 180933,
    Taipei: -1.97,
    NewTaipei_p: 102666,
    NewTaipei: -2.28,
    Taoyuan_p: 54821,
    Taoyuan: 3.17,
    Taichung_p: 62920,
    Taichung: 2.8,
    Tainan_p: 53325,
    Tainan: 1.92,
    Kaohsiung_p: 52392,
    Kaohsiung: -0.2,
    HsinchuCity_p: 62228,
    HsinchuCity: -2.38,
    HsinchuCounty_p: 53988,
    HsinchuCounty: -1.26,
    Label: "g",
    Detail: "中央銀行推出第一波選擇性信用管制"
  },
  {
    Quarter: "2021_Q1",
    Nation_p: 60680,
    Nation: 0.65,
    Taipei_p: 184075,
    Taipei: 1.74,
    NewTaipei_p: 105438,
    NewTaipei: 2.7,
    Taoyuan_p: 54267,
    Taoyuan: -1.01,
    Taichung_p: 63584,
    Taichung: 1.06,
    Tainan_p: 53340,
    Tainan: 0.03,
    Kaohsiung_p: 53183,
    Kaohsiung: 1.51,
    HsinchuCity_p: 65302,
    HsinchuCity: 4.94,
    HsinchuCounty_p: 52503,
    HsinchuCounty: -2.75,
    Label: "h",
    Detail: "中央銀行推出第二波選擇性信用管制"
  },
  {
    Quarter: "2021_Q2",
    Nation_p: 61303,
    Nation: 1.03,
    Taipei_p: 185546,
    Taipei: 0.8,
    NewTaipei_p: 104625,
    NewTaipei: -0.77,
    Taoyuan_p: 55092,
    Taoyuan: 1.52,
    Taichung_p: 65270,
    Taichung: 2.65,
    Tainan_p: 54306,
    Tainan: 1.81,
    Kaohsiung_p: 53974,
    Kaohsiung: 1.49,
    HsinchuCity_p: 63725,
    HsinchuCity: -2.41,
    HsinchuCounty_p: 56614,
    HsinchuCounty: 7.83,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2021_Q3",
    Nation_p: 62989,
    Nation: 2.75,
    Taipei_p: 188542,
    Taipei: 1.61,
    NewTaipei_p: 107946,
    NewTaipei: 3.17,
    Taoyuan_p: 56416,
    Taoyuan: 2.4,
    Taichung_p: 68182,
    Taichung: 4.46,
    Tainan_p: 55592,
    Tainan: 2.37,
    Kaohsiung_p: 56760,
    Kaohsiung: 5.16,
    HsinchuCity_p: 65202,
    HsinchuCity: 2.32,
    HsinchuCounty_p: 58629,
    HsinchuCounty: 3.56,
    Label: "i",
    Detail: "實價登錄新制2.0上路"
  },
  {
    Quarter: "2021_Q4",
    Nation_p: 66214,
    Nation: 5.12,
    Taipei_p: 186988,
    Taipei: -0.82,
    NewTaipei_p: 110780,
    NewTaipei: 2.63,
    Taoyuan_p: 59195,
    Taoyuan: 4.93,
    Taichung_p: 70032,
    Taichung: 2.71,
    Tainan_p: 58201,
    Tainan: 4.69,
    Kaohsiung_p: 59974,
    Kaohsiung: 5.66,
    HsinchuCity_p: 71161,
    HsinchuCity: 9.14,
    HsinchuCounty_p: 57743,
    HsinchuCounty: -1.51,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2022_Q1",
    Nation_p: 68650,
    Nation: 3.68,
    Taipei_p: 192461,
    Taipei: 2.93,
    NewTaipei_p: 113360,
    NewTaipei: 2.33,
    Taoyuan_p: 60903,
    Taoyuan: 2.89,
    Taichung_p: 72395,
    Taichung: 3.37,
    Tainan_p: 61778,
    Tainan: 6.15,
    Kaohsiung_p: 60010,
    Kaohsiung: 0.06,
    HsinchuCity_p: 75990,
    HsinchuCity: 6.79,
    HsinchuCounty_p: 58680,
    HsinchuCounty: 1.62,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2022_Q2",
    Nation_p: 69327,
    Nation: 0.99,
    Taipei_p: 193088,
    Taipei: 0.33,
    NewTaipei_p: 115318,
    NewTaipei: 1.73,
    Taoyuan_p: 63898,
    Taoyuan: 4.92,
    Taichung_p: 73312,
    Taichung: 1.27,
    Tainan_p: 61737,
    Tainan: -0.07,
    Kaohsiung_p: 61996,
    Kaohsiung: 3.31,
    HsinchuCity_p: 73798,
    HsinchuCity: -2.88,
    HsinchuCounty_p: 59848,
    HsinchuCounty: 1.99,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2022_Q3",
    Nation_p: 69955,
    Nation: 0.91,
    Taipei_p: 194723,
    Taipei: 0.85,
    NewTaipei_p: 115093,
    NewTaipei: -0.2,
    Taoyuan_p: 63760,
    Taoyuan: -0.22,
    Taichung_p: 74992,
    Taichung: 2.29,
    Tainan_p: 61379,
    Tainan: -0.58,
    Kaohsiung_p: 61199,
    Kaohsiung: -1.29,
    HsinchuCity_p: 74793,
    HsinchuCity: 1.35,
    HsinchuCounty_p: 62418,
    HsinchuCounty: 4.29,
    Label: "j",
    Detail: "實施300億元中央擴大租金補貼(111年度) / 中央銀行推出第三波選擇性信用管制"
  },
  {
    Quarter: "2022_Q4",
    Nation_p: 70790,
    Nation: 1.19,
    Taipei_p: 193593,
    Taipei: -0.58,
    NewTaipei_p: 114313,
    NewTaipei: -0.68,
    Taoyuan_p: 65176,
    Taoyuan: 2.22,
    Taichung_p: 74255,
    Taichung: -0.98,
    Tainan_p: 61088,
    Tainan: -0.47,
    Kaohsiung_p: 60706,
    Kaohsiung: -0.81,
    HsinchuCity_p: 81277,
    HsinchuCity: 8.67,
    HsinchuCounty_p: 62383,
    HsinchuCounty: -0.06,
    Label: "k",
    Detail: "中央銀行推出第四波選擇性信用管制"
  },
  {
    Quarter: "2023_Q1",
    Nation_p: 72408,
    Nation: 2.29,
    Taipei_p: 192998,
    Taipei: -0.31,
    NewTaipei_p: 119499,
    NewTaipei: 4.54,
    Taoyuan_p: 65616,
    Taoyuan: 0.68,
    Taichung_p: 73754,
    Taichung: -0.67,
    Tainan_p: 62195,
    Tainan: 1.81,
    Kaohsiung_p: 63396,
    Kaohsiung: 4.43,
    HsinchuCity_p: 79427,
    HsinchuCity: -2.28,
    HsinchuCounty_p: 66016,
    HsinchuCounty: 5.82,
    Label: "l",
    Detail: "立法院三讀通過《平均地權條例》修正草案 / 立法院三讀通過《地籍清理條例》部分條文修正草案 / 立法院三讀通過《租賃住宅市場發展及管理條例》（租賃專法）部分修正條文草案"
  },
  {
    Quarter: "2023_Q2",
    Nation_p: 75202,
    Nation: 3.86,
    Taipei_p: 200824,
    Taipei: 4.05,
    NewTaipei_p: 118793,
    NewTaipei: -0.59,
    Taoyuan_p: 68602,
    Taoyuan: 4.55,
    Taichung_p: 75917,
    Taichung: 2.93,
    Tainan_p: 66757,
    Tainan: 7.33,
    Kaohsiung_p: 64594,
    Kaohsiung: 1.89,
    HsinchuCity_p: 83803,
    HsinchuCity: 5.51,
    HsinchuCounty_p: 70744,
    HsinchuCounty: 7.16,
    Label: "m",
    Detail: "中央銀行推出第五波選擇性信用管制"
  },
  {
    Quarter: "2023_Q3",
    Nation_p: 76524,
    Nation: 1.76,
    Taipei_p: 202700,
    Taipei: 0.93,
    NewTaipei_p: 120985,
    NewTaipei: 1.85,
    Taoyuan_p: 69653,
    Taoyuan: 1.53,
    Taichung_p: 76473,
    Taichung: 0.73,
    Tainan_p: 66732,
    Tainan: -0.04,
    Kaohsiung_p: 66465,
    Kaohsiung: 2.9,
    HsinchuCity_p: 87252,
    HsinchuCity: 4.12,
    HsinchuCounty_p: 69161,
    HsinchuCounty: -2.24,
    Label: "n",
    Detail: "實施300億元中央擴大租金補貼(112-113年度) / 「新青安貸款方案」上路"
  },
  {
    Quarter: "2023_Q4",
    Nation_p: 78408,
    Nation: 2.46,
    Taipei_p: 204372,
    Taipei: 0.82,
    NewTaipei_p: 122043,
    NewTaipei: 0.87,
    Taoyuan_p: 71225,
    Taoyuan: 2.26,
    Taichung_p: 79197,
    Taichung: 3.56,
    Tainan_p: 68614,
    Tainan: 2.82,
    Kaohsiung_p: 67920,
    Kaohsiung: 2.19,
    HsinchuCity_p: 87222,
    HsinchuCity: -0.03,
    HsinchuCounty_p: 74197,
    HsinchuCounty: 7.28,
    Label: "o",
    Detail: "立法院三讀通過《房屋稅條例》修正草案（囤房稅2.0）"
  },
  {
    Quarter: "2024_Q1",
    Nation_p: 81057,
    Nation: 3.38,
    Taipei_p: 209341,
    Taipei: 2.43,
    NewTaipei_p: 127618,
    NewTaipei: 4.57,
    Taoyuan_p: 74062,
    Taoyuan: 3.98,
    Taichung_p: 80826,
    Taichung: 2.06,
    Tainan_p: 68700,
    Tainan: 0.13,
    Kaohsiung_p: 71975,
    Kaohsiung: 5.97,
    HsinchuCity_p: 91250,
    HsinchuCity: 4.62,
    HsinchuCounty_p: 77083,
    HsinchuCounty: 3.89,
    Label: null,
    Detail: null
  },
  {
    Quarter: "2024_Q2",
    Nation_p: 84757,
    Nation: 4.56,
    Taipei_p: 218994,
    Taipei: 4.61,
    NewTaipei_p: 132190,
    NewTaipei: 3.58,
    Taoyuan_p: 75546,
    Taoyuan: 2,
    Taichung_p: 86306,
    Taichung: 6.78,
    Tainan_p: 74638,
    Tainan: 8.64,
    Kaohsiung_p: 76666,
    Kaohsiung: 6.52,
    HsinchuCity_p: 97483,
    HsinchuCity: 6.83,
    HsinchuCounty_p: 82828,
    HsinchuCounty: 7.45,
    Label: "p",
    Detail: "中央銀行推出第六波選擇性信用管制 / 實施「新青安貸款精進方案」"
  },
  {
    Quarter: "2024_Q3",
    Nation_p: 82849,
    Nation: -2.25,
    Taipei_p: 220247,
    Taipei: 0.57,
    NewTaipei_p: 131263,
    NewTaipei: -0.7,
    Taoyuan_p: 78326,
    Taoyuan: 3.68,
    Taichung_p: 85408,
    Taichung: -1.04,
    Tainan_p: 69404,
    Tainan: -7.01,
    Kaohsiung_p: 74341,
    Kaohsiung: -3.03,
    HsinchuCity_p: 98755,
    HsinchuCity: 1.3,
    HsinchuCounty_p: 80835,
    HsinchuCounty: -2.41,
    Label: "q",
    Detail: "「租屋電費新制」上路 / 立法院三讀通過《土地法》第14條修正案 / 立法院三讀通過《不動產估價師法》部分條文修正草案 / 銀行不動產放款比重創新高，房貸緊縮新聞陸續曝光 / 「租屋族免費租屋法律諮詢服務」上路 / 內政部公布大學周邊租金統計資料 / 內政部公布各行政區租金統計資料 / 中央銀行推出第七波選擇性信用管制"
  },
  {
    Quarter: "2024_Q4",
    Nation_p: 72363,
    Nation: -12.66,
    Taipei_p: 206157,
    Taipei: -6.4,
    NewTaipei_p: 120181,
    NewTaipei: -8.44,
    Taoyuan_p: 74450,
    Taoyuan: -4.95,
    Taichung_p: 78538,
    Taichung: -8.04,
    Tainan_p: 65217,
    Tainan: -6.03,
    Kaohsiung_p: 60296,
    Kaohsiung: -18.89,
    HsinchuCity_p: 90909,
    HsinchuCity: -7.94,
    HsinchuCounty_p: 69506,
    HsinchuCounty: -14.01,
    Label: "r",
    Detail: "立法院三讀通過《國土計畫法》修正案延期6年至2031年"
  }
];

        let selectedKey = "Nation";

        const x = d3.scaleBand()
            .domain(data.map(d => d.Quarter))
            .range([0, width])
            .paddingInner(0.5)
            .paddingOuter(1);

        const y = d3.scaleLinear()
            .range([height, 0]);

        const xAxis = d3.axisBottom(x).tickFormat(d => d.includes("Q1") ? d : "");
        const yAxis = d3.axisLeft(y).tickFormat(d => d + "%");

        const xAxisGroup = svg.append("g").attr("class","x-axis")

        svg.append("g").attr("class", "y-axis");

        svg.selectAll(".bar")
            .data(data)
            .enter().append("rect")
            .attr("class", "bar")
            .on("mouseover", function(event, d) {
                const value = d[selectedKey];
                const price = d[selectedKey + "_p"]
                const sign = value >= 0 ? "+" : "";
                d3.select("#tooltip")
                    .style("display", "block")
                    .style("left", `${event.pageX + 5}px`)
                    .style("top", `${event.pageY - 30}px`)
                    .html(`<b>${d.Quarter}</b><br>${price}元/坪<br>${sign}${value}%`);
            })
            .on("mouseout", function() {
                d3.select("#tooltip").style("display", "none");
            });

        // Function to update chart
        function updateChart() {
            y.domain([
                d3.min(data, d => d[selectedKey]) - 2, 
                d3.max(data, d => d[selectedKey]) + 2
            ]);

            svg.select(".y-axis").transition().duration(1000).call(yAxis);

            svg.selectAll(".bar")
                .data(data)
                .transition().duration(1000)
                .attr("x", d => x(d.Quarter))
                .attr("y", d => y(Math.max(0, d[selectedKey])))
                .attr("width", x.bandwidth())
                .attr("height", d => Math.abs(y(d[selectedKey]) - y(0)))
                .attr("fill", d => d[selectedKey] >= 0 ? "steelblue" : "red");
          
            xAxisGroup.transition().duration(1000)
              .attr("transform", `translate(0,${y(0)})`)
              .call(xAxis)
              .selectAll("text")
              .style("text-anchor", "middle");
          
            xAxisGroup.raise();
        }

        d3.select("#dataSelect").on("change", function() {
            selectedKey = this.value;
            updateChart();
        });

        const timeline = svg.append("g")
            .attr("transform", `translate(0,${height + 10})`);

        const timelineAxis = d3.axisBottom(x).tickFormat(d => d.includes("Q1") ? d : "");

        timeline.append("g")
            .attr("class", "timeline-axis")
            .call(timelineAxis);

        timeline.selectAll(".timeline-point")
            .data(data)
            .enter().append("circle")
            .attr("class", "timeline-point")
            .attr("cx", d => x(d.Quarter) + x.bandwidth() / 2)
            .attr("cy", -5)
            .attr("r", 8)
            .attr("fill", d => d.Label ? "orange" : "transparent")
            .on("mouseover", function(event, d) {
                if (d.Label) {
                    d3.select("#tooltip")
                        .style("display", "block")
                        .style("left", `${event.pageX + 5}px`)
                        .style("top", `${event.pageY - 30}px`)
                        .html(`<b>${d.Quarter}</b><br>${d.Detail}`);
                }
            })
            .on("mouseout", function() {
                d3.select("#tooltip").style("display", "none");
            });

        updateChart();
  </script>

</html>
